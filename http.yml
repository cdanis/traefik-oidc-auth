http:
  services:
    whoami:
      loadBalancer:
        servers:
          - url: http://whoami:80

  middlewares:
    oidc-auth:
      plugin:
        traefik-oidc-auth:
          CallbackUri: "http://auth-next.ninefives.online:9080/oidc/callback"
          LogLevel: DEBUG
          Provider:
            UrlEnv: "PROVIDER_URL"
            ClientIdEnv: "CLIENT_ID"
            ClientSecretEnv: "CLIENT_SECRET"
            UsePkce: false
          SessionCookie:
            Secure: false
            Domain: "ninefives.online"
            Name: "ooooo"
          Scopes: ["openid", "profile", "email", "groups"]
          Headers:
            - Name: "X-Oidc-Username"
              Value: "{{`{{ .claims }}`}}"
            - Name: "X-Oidc-Subject"
              Value: "sub"
            - Name: "Authorization"
              Value: "{{`Bearer {{ .accessToken }}`}}"
          #UnauthorizedBehavior: "Unauthorized"
          # Authorization:
          #   AssertClaims:
          #     - Name: roles
          #       AnyOf: ["admin", "media"]
          #     - Name: some.nested.key
          #       AnyOf: ["some value"]
          # If set, only the /login endpoint will initiate the login flow
          #LoginUri: "/login"
          #PostLoginRedirectUri: "/"

  routers:
    whoami:
      #entryPoints: ["web"]
      #rule: "HostRegexp(`.+`)"
      rule: PathPrefix(`/`)
      service: whoami
      middlewares: ["oidc-auth@file"]
